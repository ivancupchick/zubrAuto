<div class="card">
  <div class="card-body">
    <form
      *ngIf="form"
      [formGroup]="form"
      (ngSubmit)="filter()">
      <div class="flex flex-row justify-content-start align-items-center row-gap-1 col-12">
        <input
          class="ml-2 p-inputtext"
          type="text"
          formControlName="mark"
          pInputText
          placeholder="Марка"/>

        <p-multiSelect
          *ngIf="availableCarStatuses.length > 1"
          class="ml-2"
          formControlName="status"
          [options]="availableCarStatuses"
          placeholder="Статус"
          optionLabel="label"
          optionValue="value"
          selectedItemsLabel="{0} статусов выбрано"
          [maxSelectedLabels]="1"
        ></p-multiSelect>

        <!-- *ngIf="onSelectContactUserAvailable && contactCenterUserOptions.length > 0 " -->
        <p-dropdown

          class="ml-2"
          [options]="contactCenterUserOptions"
          formControlName="selectedContactCenterUser"
          placeholder="Сотрудник ОКЦ"
          [filter]="true"
          filterBy="name"
          optionLabel="label"
          optionValue="key"
          [showClear]="true"
        ></p-dropdown>

        <p-calendar
          class="ml-2"
          formControlName="date"
          selectionMode="range"
          [showTime]="false"
          [showButtonBar]="true"
          placeholder="Даты"
          [firstDayOfWeek]="1"
          [showClear]="true"></p-calendar>

        <input
          pInputText
          class="ml-2 p-inputtext"
          type="text"
          formControlName="number"
          pInputText
          placeholder="Телефон"/>

      </div>

      <p-toolbar>
        <div class="p-toolbar-group-left">
          <span>Выбрано автомобилей: {{getAllSelectedCars()}}</span>
          <span>Всего автомобилей: {{sortedCars.length}}</span>
          <span>Кол-во: {{ (carsBaseDataService.list$ | async)?.total || 0 }}</span> <!-- Быть не должно, но уверен  еще пригодится-->

          <button
            pButton
            type="button"
            label="Добавить машину"
            icon="pi pi-plus"
            (click)="openNewCarWindow()"
          ></button>
        </div>

        <div class="p-toolbar-group-right">
          <p-button size="small" label="Получить" type="submit" (onClick)="filter()" class="mr-2">
            <i class="pi pi-refresh"></i>
          </p-button>
          <p-button size="small" type="button" label="Очистить" (onClick)="clearFilters()" class="mr-2">
          </p-button>
        </div>
      </p-toolbar>
    </form>
  </div>
</div>

<div class="grid-wrapper">
  <za-pageagle-grid
    [gridConfig]="gridConfig"
    [actions]="gridActionsConfig"
    [getColorConfig]="getColorConfig"
    [dataService]="carsBaseDataService"
    [sortField]="'createdDate'"
    [first] = "first"
  ></za-pageagle-grid>
</div>

<za-spinner *ngIf="loading$ | async"></za-spinner>
